<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Edit Order Status | FluffyFriend</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #fff6fb;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    main {
      flex: 1;
      padding-bottom: 2rem;
    }
    .navbar {
      background: linear-gradient(90deg, #ff8db8, #ff6fa3);
    }
    .navbar-brand {
      color: white;
      font-weight: 700;
    }
    .card-shell {
      background: #fff;
      border-radius: 24px;
      padding: 2rem;
      box-shadow: 0 25px 60px rgba(255,111,163,0.2);
    }
    .summary-pill {
      background: #ffe3f0;
      border-radius: 12px;
      padding: 1rem;
    }
    .summary-pill span {
      display: block;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #a66384;
    }
    .summary-pill strong {
      font-size: 1.35rem;
      color: #ff6fa3;
    }
    .btn-pink {
      background: #ff6fa3;
      color: #fff;
      border: none;
    }
    .btn-pink:hover {
      background: #ff8db8;
      color: #fff;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <%- include('partials/admin_navbar') %>

  <main class="container my-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h2 class="fw-bold mb-0">Edit Order Status</h2>
        <p class="text-muted mb-0">Update fulfillment for this order.</p>
      </div>
      <a href="/admin/orders" class="btn btn-outline-secondary">Back to Orders</a>
    </div>

    <% if (success && success.length) { %>
      <div class="alert alert-success"><%= success[0] %></div>
    <% } %>
    <% if (error && error.length) { %>
      <div class="alert alert-danger"><%= error[0] %></div>
    <% } %>

    <div class="card-shell">
      <div class="row g-3 mb-4">
        <div class="col-md-4">
          <div class="summary-pill">
            <span>Invoice</span>
            <strong><%= order.invoice_number %></strong>
          </div>
        </div>
        <div class="col-md-4">
          <div class="summary-pill">
            <span>Total Amount</span>
            <strong>$<%= Number(order.total || 0).toFixed(2) %></strong>
          </div>
        </div>
        <div class="col-md-4">
          <div class="summary-pill">
            <span>Current Status</span>
            <strong><%= order.status || 'Pending Order' %></strong>
          </div>
        </div>
      </div>

      <form action="/admin/orders/<%= order.id %>/edit" method="POST">
        <div class="mb-3">
          <label for="status" class="form-label fw-semibold">Order Status</label>
          <select id="status" name="status" class="form-select" required>
            <% statuses.forEach(function(status) { %>
              <option value="<%= status %>" <%= (order.status || 'Pending Order') === status ? 'selected' : '' %>><%= status %></option>
            <% }); %>
          </select>
        </div>
        <button type="submit" class="btn btn-pink px-4">Save Status</button>
      </form>
    </div>
  </main>

  <%- include('partials/footer') %>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
